<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="./assets/images/favicon.png" />
    <link rel="stylesheet" href="./css/media.css" />
    <link rel="stylesheet" href="./css/index.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
      integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
      integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p"
      crossorigin="anonymous"
    />

    <title>AEPS-OPEN</title>
  </head>

  <body>
    <nav
      class="navbar sticky-top nav-shadow navbar-expand-lg navbar-light bg-light"
      style="background-color: #fff"
    >
      <div class="container-fluid">
        <a class="navbar-brand" href="./index.html"
          ><img
            src="./assets/images/alliance-logo.png"
            alt=""
            width="280"
            height="150"
            class="d-inline-block align-text-top"
        /></a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div>
          <div class="language">
            <a href="#" onclick="setLanguage('en')" class="language-item">
              <p class="mr-3">
                <img
                  src="./assets/images/english.png"
                  class="mr-1"
                  width="20px"
                  height="20px"
                  alt=""
                />English
              </p>
            </a>
            <a href="#" onclick="setLanguage('es')" class="language-item">
              <p>
                <img
                  src="./assets/images/spanish.png"
                  width="20px"
                  height="20px"
                  alt=""
                />
                Spanish
              </p>
            </a>
          </div>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul id="nave" class="navbar-nav ml-auto mr-3">
              <li id="homes" class="nav-item">
                <a class="nav-link" aria-current="page" href="./index.html"
                  ></a
                >
              </li>
              <li id="tool" class="nav-item ml-4">
                <a class="nav-link" href="./tools.html"></a>
              </li>
              <li id="service" class="nav-item ml-4">
                <a class="nav-link" href="./services.html"></a>
              </li>
              <li id="success" class="nav-item ml-4">
                <a class="nav-link" href="./success-cases.html"
                  ></a
                >
              </li>
              <li id="media" class="nav-item ml-4">
                <a class="nav-link active" href="./media.html"></a>
              </li>
              <li id="article" class="nav-item ml-4">
                <a class="nav-link" href="./articles.html"></a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </nav>
    <!-- content -->
    <div class="container">
      <!-- Description content -->
      <div class="row">
        <div class="flex-content">
          <div class="text-description">
            <h1 id="title"><!-- CONTENIDO MULTIMEDIA --></h1>
            <p id="description">
              <!-- A continuación podrá ver los webinars, videos, documentales y
              demas elementos multimedia que ha ido dejando el equipo en su
              recorrido. -->
            </p>
          </div>
          <div class="icon-description">
            <img src="./assets/images/media.png" alt="" width="300px" />
          </div>
        </div>
      </div>
      <hr />
      <!-- Content -->
      <div class="row">
        <div class="background-media mb-4">
          <div class="flex-content-eithy"></div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="logo">
        <img
          src="./assets/images/alliance-logo-trans.png"
          class="mt-3"
          alt=""
          width="250px"
          height="150px"
        />
        <img
          src="./assets/images/ccafs.png"
          class="mt-4 ml-3"
          alt=""
          height="120px"
        />
      </div>
      <div class="contact">
        <div>
          <h4 id="footer-contact-title" class="mt-3">CONTACTO</h4>
          <h5 id="footer-researcher">Daniel Jimenez, PhD. Científico</h5>
          <h5><i class="far fa-envelope mr-1"></i>d.jimenez@cgiar.org</h5>
        </div>
        <!--  <div style="float: right;">
                 
              </div> -->
      </div>
      <div class="qr ml-4">
        <h5 id="footer-qr-title" class="mt-3">Conoce más en:</h5>
        <img src="./assets/images/qr.png" class="mt-2" alt="" height="80px" />
      </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.3.1.js"
      integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
      integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"
      integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s"
      crossorigin="anonymous"
    ></script>
    <script>
      var language;
      function getLanguage() {
        getItems(localStorage.getItem("language"))
        localStorage.getItem("language") == null ? setLanguage("en") : false;
        $.ajax({
          url: "language/" + localStorage.getItem("language") + ".json",
          dataType: "json",
          async: true,
          dataType: "json",
          success: function (lang) {
            language = lang;
            /* Navbar */
            document.getElementById("homes").innerHTML =
              "<li id='homes' class='nav-item ml-3'>" +
              "<a class='nav-link' href='./index.html'>" +
              language.index.navbar[0] +
              "</a></li>";
            document.getElementById("tool").innerHTML =
              "<li id='tool' class='nav-item ml-3'>" +
              "<a class='nav-link' href='./tools.html'>" +
              language.index.navbar[1] +
              "</a></li>";
            document.getElementById("service").innerHTML =
              "<li id='service' class='nav-item ml-3'>" +
              "<a class='nav-link' href='./services.html'>" +
              language.index.navbar[2] +
              "</a></li>";
            document.getElementById("success").innerHTML =
              "<li id='tool' class='nav-item ml-3'>" +
              "<a class='nav-link' href='./success-cases.html'>" +
              language.index.navbar[3] +
              "</a></li>";
            document.getElementById("media").innerHTML =
              "<li id='tool' class='nav-item ml-3'>" +
              "<a class='nav-link active' href='./media.html'>" +
              language.index.navbar[4] +
              "</a></li>";
            document.getElementById("article").innerHTML =
              "<li id='tool' class='nav-item ml-3'>" +
              "<a class='nav-link' href='./articles.html'>" +
              language.index.navbar[5] +
              "</a></li>";
            /* Content */
            document.getElementById("title").innerHTML = language.media.title;
            document.getElementById("description").innerHTML =
              language.media.description;
            /* Footer */
            document.getElementById("footer-contact-title").innerHTML =
              language.index.footer.contact_title;
            document.getElementById("footer-researcher").innerHTML =
              language.index.footer.researcher;
            document.getElementById("footer-qr-title").innerHTML =
              language.index.footer.qr_title;
          },
        });
      }

      function getItems(lan) {
        $(document).ready(function () {
          $.ajax({
            type: "GET",
            url: "db/media.csv",
            dataType: "text",
            success: function (data) {
              mediaContent = processData(data);
              $(".flex-content-eithy").html("");
              if (lan == "es") {
                $(mediaContent).each(function (i, e) {
                  $(".flex-content-eithy").append(
                    '<div class="media-content mt-1"><h5>' +
                      mediaContent[i].title_es + "</h5>" + 
                      '<iframe width="400" height="238" src="' +
                      mediaContent[i].link +
                      '" title="YouTube video player" frameborder="0"' +
                      'allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"' +
                      "allowfullscreen ></iframe> </div>"
                  );
                });
              }
              if (lan == "en") {
                $(mediaContent).each(function (i, e) {
                  $(".flex-content-eithy").append(
                    '<div class="media-content"><h5>' +
                      mediaContent[i].title_en +
                      "</h5>" +
                      '<iframe width="400" height="238" src="' +
                      mediaContent[i].link +
                      '" title="YouTube video player" frameborder="0"' +
                      'allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"' +
                      "allowfullscreen ></iframe> </div>"
                  );
                });
              }
            },
          });
        });
      }

      function processData(allText) {
        var allTextLines = allText.split(/\r\n|\n/);
        var entries = allTextLines[0].split(";");
        var lines = [];
        var record_num = 8; // or however many elements there are in each row

        var headings = entries.splice(0, 5);
        var tarr = [];

        for (let i = 1; i < allTextLines.length; i++) {
          var obj = {};
          var currentline = allTextLines[i].split(";");
          for (var j = 0; j < headings.length; j++) {
            obj[headings[j]] = currentline[j];
          }
          lines.push(obj);
        }
        return lines;
      }

      function setLanguage(lang) {
        localStorage.setItem("language", lang);
        getLanguage();
      }
    </script>
    <script>
      $(document).ready(function () {
        getLanguage();
      });
    </script>
  </body>
</html>
